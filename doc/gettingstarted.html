<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Couchbeam - Getting started
</title>
    <!--[if IE]>

    <script>
        // allow IE to recognize HTMl5 elements
        document.createElement('section');
        document.createElement('article');
        document.createElement('aside');
        document.createElement('footer');
        document.createElement('header');
        document.createElement('nav');
        document.createElement('time');

    </script>
    
    <![endif]-->
    <link rel="stylesheet" href="css/couchbeam.css?20091017" type="text/css" media="screen, projection" />
</head>
<body>
  <div id="container">
  <header id="mainhead">
    <h1><a href="index.html">Couchbeam 0.4.3</a></h1>
    <p id="download">get the source in <a href="http://github.com/benoitc/couchbeam">git</a> or <a href="http://bitbucket.org/benoitc/couchbeam">hg</a>, then <a href="http://github.com/benoitc/couchbeam/issues">send feedback</a></p>
    
  </header>
  
  <section id="content">
    <h1>Getting Started</h1>
    
    <p>This tutorial exposes key features of <strong>couchbeam</strong> through mainly code examples. For in-depth description of the modules, you’ll want to read the <a href="doc/">API</a> documentation.

    If you have not installed couchbeam yet, follow instruction on <a href="download.html">download</a> page .

    <h2>Data structures</h2>

    <p>For now when working witch couchbeam you may have to use one data structure that represents a connection to a <a href="http://apache.couchdb.org">CouchDB</a> node :</p>


    <h3>#couchdb_params{}</h3>

    <p>This data structure represents a connection to a <a href="http://apache.couchdb.org">CouchDB</a> node.</p>

    <script src="http://friendpaste.com/K1uvRKyCBA8RDnTZDk5Hw.js"></script>

    <h2>Basic Api</h2>

    <p>If you browse the couchbeam source code, you will notice it is based on OTP principles. It also use a modified (soon) lhttpc client to manage http connections. All http connections are reused. Some important modules are :</p>

    <table>
      <tr>
        <th>File</th>
        <th>Description</th>
      </tr>
      <tr>
        <td>couchbeam</td><td>Library initialization</td>
      </tr>
      <tr>
        <td>couchbeam_db</td><td>High level functions for manipulating docs</td>
      </tr>
      <tr>
        <td>couchbeam_doc</td><td>Utilities function to manipulate content of CouchDB documents</td>
      </tr>
      <tr>
        <td>couchbeam_server</td><td>High level functions for managin server and initiate connections</td>
      </tr>
      <tr>
        <td>couchbeam_view</td><td>High level functions for manipulating views</td>
      </tr>
    </table>

    <p>Look at the couchbeam sources for the complete list.</p>

    <p>But enough writing. Let's start by a quick example in the console:</p>

    <script src="http://friendpaste.com/6Y0iq1yHhBR5N7yKVwlNYo.js"></script>
    
    <p>Edit This doc and save it again :</p>

    <script src="http://friendpaste.com/1l630DUxYsqysCLYCBoO7e.js"></script>

    <p>Get this doc :</p>

    <script src="http://friendpaste.com/6pM71WsfW5Eacxqz2pKpAj.js"></script>


    <p>We have used the Connection pid to create database. But each connections can be and should be named. By default connection is 127.0.0.1:5984 and is named default. You can create your own connection by passing a <code>#couchdb_params{}</code> record to <code>couchbeam_server:start_connection_link()</code> function.</p>

    <p>ALso each database could be named so you could reuse its pid easily in your project without having to open/close it <code>couchbeam_db:open_db(Connection, {testdb, "testdb"})</code> and now use testdb instead db pid.</p>

    <p>Ex :</p>

    <script src="http://friendpaste.com/2zxgNtZ349lSRq6Udy5RPo.js"></script>


    <h2>View Api :</h2>

    <p>Now that we saw the bases, here is a quick introduction to the view api.</p>

    <p>First we create some documents :</p>

    <script src="http://friendpaste.com/1raNBVEOT6QIJeJGrgMGbp.js"></script>

    <p>Each view is managed by a gen_server. It allow us to keep state and maintain cache. You need to force refresh to refresh data in your view. In the future we will have the possibility to refresh the view on changes.</p>

    <p>Initiate a view :</p>

    <script src="http://friendpaste.com/2hrMYphio5YFPqP7g7t77C.js"></script>

    <p>Get number of results :</p>

    <script src="http://friendpaste.com/4Zxz4IB9xl3Ug0EFP0323Z.js"></script>

    <p>Get parsed results :</p>

    <script src="http://friendpaste.com/5Tia1KUIRJar0qxi70b9r7.js"></script>

    <p>Close the view :</p>

    <script src="http://friendpaste.com/1oT652i7O2K88D7Q2HaFJI.js"></script>

    <p>That's all for now</p>
  </section>
  
  <footer>
    <p>2009-2010 &copy; <a href="http://benoitc.im">Benoît Chesneau</a> - Some rights resenved</p>
  </footer>
  </div>
</body>